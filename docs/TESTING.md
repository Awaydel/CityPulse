# ğŸ§ª Ğ¡Ñ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ñ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ EcoSense

## ĞĞ±Ğ·Ğ¾Ñ€

Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚ Ğ¾Ğ¿Ğ¸ÑÑ‹Ğ²Ğ°ĞµÑ‚ Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´ Ğº Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ° EcoSense Ğ½Ğ° Ğ²ÑĞµÑ… ÑƒÑ€Ğ¾Ğ²Ğ½ÑÑ…: Ğ¾Ñ‚ unit-Ñ‚ĞµÑÑ‚Ğ¾Ğ² Ğ´Ğ¾ end-to-end Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¾Ğº.

---

## Ğ£Ñ€Ğ¾Ğ²Ğ½Ğ¸ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    E2E Tests                            â”‚
â”‚              (Browser Automation)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                 Integration Tests                       â”‚
â”‚           (API + Database + Frontend)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    Unit Tests                           â”‚
â”‚         (Functions, Components, Utilities)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 1. Unit Tests

### Backend (Python)

| ĞœĞ¾Ğ´ÑƒĞ»ÑŒ | Ğ§Ñ‚Ğ¾ Ñ‚ĞµÑÑ‚Ğ¸Ñ€ÑƒĞµĞ¼ | Ğ˜Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ñ‹ |
|--------|---------------|-------------|
| `etl.py` | `transform_data()` â€” ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ğ¾ÑÑ‚ÑŒ Ğ¿Ñ€ĞµĞ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ | pytest |
| `etl.py` | `train_and_predict_ml()` â€” Ğ¾Ğ±ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸ | pytest + sklearn |
| `server.py` | Ğ­Ğ½Ğ´Ğ¿Ğ¾Ğ¸Ğ½Ñ‚Ñ‹ API | pytest + httpx |

**ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ñ‚ĞµÑÑ‚Ğ°:**

```python
# tests/test_etl.py
import pytest
from services.etl import transform_data

def test_transform_data_merges_correctly():
    weather = {
        'hourly': {
            'time': ['2024-01-01T00:00'],
            'temperature_2m': [20.5],
            'relative_humidity_2m': [65],
            'wind_speed_10m': [10.2]
        }
    }
    air_quality = {
        'hourly': {
            'time': ['2024-01-01T00:00'],
            'pm10': [25.0],
            'pm2_5': [12.5]
        }
    }
    
    df = transform_data(weather, air_quality)
    
    assert len(df) == 1
    assert df.iloc[0]['temperature'] == 20.5
    assert df.iloc[0]['pm25'] == 12.5
```

### Frontend (TypeScript)

| ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚ | Ğ§Ñ‚Ğ¾ Ñ‚ĞµÑÑ‚Ğ¸Ñ€ÑƒĞµĞ¼ | Ğ˜Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ñ‹ |
|-----------|---------------|-------------|
| `api.ts` | ĞŸĞ°Ñ€ÑĞ¸Ğ½Ğ³ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ¾Ğ² API | Vitest |
| `DashboardCharts.tsx` | Ğ ĞµĞ½Ğ´ĞµÑ€Ğ¸Ğ½Ğ³ Ğ³Ñ€Ğ°Ñ„Ğ¸ĞºĞ¾Ğ² | Vitest + React Testing Library |

---

## 2. Integration Tests

### API + Database

| Ğ¢ĞµÑÑ‚ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | ĞœĞµÑ‚Ğ¾Ğ´ |
|------|----------|-------|
| `GET /api/cities` | Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ ÑĞ¿Ğ¸ÑĞ¾Ğº Ğ³Ğ¾Ñ€Ğ¾Ğ´Ğ¾Ğ² Ğ¸Ğ· Ğ‘Ğ” | HTTP request + Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° JSON |
| `GET /api/measurements` | Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ´Ğ»Ñ Ğ³Ğ¾Ñ€Ğ¾Ğ´Ğ° | HTTP request + Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñ‹ |
| ETL â†’ DB | Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ğ¾ Ğ·Ğ°Ğ¿Ğ¸ÑÑ‹Ğ²Ğ°ÑÑ‚ÑÑ | Ğ—Ğ°Ğ¿ÑƒÑĞº ETL + SELECT Ğ¸Ğ· Ğ‘Ğ” |

**ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ñ‚ĞµÑÑ‚Ğ°:**

```python
# tests/test_api.py
from fastapi.testclient import TestClient
from server import app

client = TestClient(app)

def test_get_cities():
    response = client.get("/api/cities")
    assert response.status_code == 200
    assert "cities" in response.json()

def test_get_measurements_requires_city():
    response = client.get("/api/measurements")
    assert response.status_code == 422  # Validation error
```

---

## 3. Data Quality Tests

ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸ ĞºĞ°Ñ‡ĞµÑÑ‚Ğ²Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ÑÑÑ‚ÑÑ Ğ² QA-Ğ¼Ğ¾Ğ´ÑƒĞ»Ğµ Ğ½Ğ° Ğ´Ğ°ÑˆĞ±Ğ¾Ñ€Ğ´Ğµ:

| ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | ĞŸĞ¾Ñ€Ğ¾Ğ³ |
|----------|----------|-------|
| **Freshness** | Ğ¡Ğ²ĞµĞ¶ĞµÑÑ‚ÑŒ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½ĞµĞ¹ Ğ·Ğ°Ğ¿Ğ¸ÑĞ¸ | < 24 Ñ‡Ğ°ÑĞ° |
| **Completeness** | Ğ”Ğ¾Ğ»Ñ Ğ·Ğ°Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ½Ñ‹Ñ… Ğ¿Ğ¾Ğ»ĞµĞ¹ PM2.5 | > 90% |
| **Range** | PM2.5 Ğ² Ğ´Ğ¾Ğ¿ÑƒÑÑ‚Ğ¸Ğ¼Ğ¾Ğ¼ Ğ´Ğ¸Ğ°Ğ¿Ğ°Ğ·Ğ¾Ğ½Ğµ | 0â€“500 Ğ¼ĞºĞ³/Ğ¼Â³ |
| **Uniqueness** | ĞĞµÑ‚ Ğ´ÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ‚Ğ¾Ğ² Ğ¿Ğ¾ timestamp | 0 Ğ´ÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ‚Ğ¾Ğ² |
| **WHO Threshold** | Ğ”Ğ½Ğ¸ Ñ Ğ¿Ñ€ĞµĞ²Ñ‹ÑˆĞµĞ½Ğ¸ĞµĞ¼ Ğ½Ğ¾Ñ€Ğ¼Ñ‹ Ğ’ĞĞ— | Ğ˜Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ğ¾ |

---

## 4. E2E Tests

### Ğ¡Ñ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¸

| Ğ¡Ñ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¹ | Ğ¨Ğ°Ğ³Ğ¸ | ĞĞ¶Ğ¸Ğ´Ğ°ĞµĞ¼Ñ‹Ğ¹ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚ |
|----------|------|---------------------|
| ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ Ğ´Ğ°ÑˆĞ±Ğ¾Ñ€Ğ´Ğ° | ĞÑ‚ĞºÑ€Ñ‹Ñ‚ÑŒ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ â†’ Ğ’Ñ‹Ğ±Ñ€Ğ°Ñ‚ÑŒ Ğ³Ğ¾Ñ€Ğ¾Ğ´ | Ğ“Ñ€Ğ°Ñ„Ğ¸ĞºĞ¸ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶Ğ°ÑÑ‚ÑÑ |
| Ğ¡Ğ¼ĞµĞ½Ğ° Ğ³Ğ¾Ñ€Ğ¾Ğ´Ğ° | Ğ’Ñ‹Ğ±Ñ€Ğ°Ñ‚ÑŒ Ğ´Ñ€ÑƒĞ³Ğ¾Ğ¹ Ğ³Ğ¾Ñ€Ğ¾Ğ´ Ğ² ÑĞµĞ»ĞµĞºÑ‚Ğµ | Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ÑÑÑ‚ÑÑ |
| QA Ğ¾Ñ‚Ñ‡Ñ‘Ñ‚ | ĞŸĞµÑ€ĞµĞ¹Ñ‚Ğ¸ Ğ½Ğ° Ğ²ĞºĞ»Ğ°Ğ´ĞºÑƒ QA | ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸ ĞºĞ°Ñ‡ĞµÑÑ‚Ğ²Ğ° Ğ¿Ğ¾ĞºĞ°Ğ·Ğ°Ğ½Ñ‹ |

**Ğ˜Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ñ‹:** Playwright Ğ¸Ğ»Ğ¸ Cypress

---

## 5. Ğ—Ğ°Ğ¿ÑƒÑĞº Ñ‚ĞµÑÑ‚Ğ¾Ğ²

### Backend

```bash
# Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ĞµĞ¹ Ğ´Ğ»Ñ Ñ‚ĞµÑÑ‚Ğ¾Ğ²
pip install pytest pytest-asyncio httpx

# Ğ—Ğ°Ğ¿ÑƒÑĞº Ñ‚ĞµÑÑ‚Ğ¾Ğ²
pytest tests/ -v
```

### Frontend

```bash
# Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ°
npm install -D vitest @testing-library/react

# Ğ—Ğ°Ğ¿ÑƒÑĞº
npm run test
```

---

## Ğ¢ĞµĞºÑƒÑ‰ĞµĞµ Ğ¿Ğ¾ĞºÑ€Ñ‹Ñ‚Ğ¸Ğµ

| Ğ£Ñ€Ğ¾Ğ²ĞµĞ½ÑŒ | Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ | ĞŸĞ¾ĞºÑ€Ñ‹Ñ‚Ğ¸Ğµ |
|---------|--------|----------|
| Unit Tests (Backend) | ğŸŸ¡ ĞŸĞ»Ğ°Ğ½Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ | 0% |
| Unit Tests (Frontend) | ğŸŸ¡ ĞŸĞ»Ğ°Ğ½Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ | 0% |
| Integration Tests | ğŸŸ¡ ĞŸĞ»Ğ°Ğ½Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ | 0% |
| Data Quality Tests | âœ… Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ¾ | 100% (Ğ² UI) |
| E2E Tests | ğŸŸ¡ ĞŸĞ»Ğ°Ğ½Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ | 0% |

---

## Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ†Ğ¸Ğ¸ Ğ¿Ğ¾ Ñ€Ğ°Ğ·Ğ²Ğ¸Ñ‚Ğ¸Ñ

1. **Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ pytest Ñ‚ĞµÑÑ‚Ñ‹** Ğ´Ğ»Ñ `etl.py` Ğ¸ `server.py`
2. **Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Vitest** Ğ´Ğ»Ñ React-ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ¾Ğ²
3. **ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ÑŒ CI/CD** Ñ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ¾Ğ¼ Ñ‚ĞµÑÑ‚Ğ¾Ğ² Ğ½Ğ° push
4. **Mock Open-Meteo API** Ğ´Ğ»Ñ ÑÑ‚Ğ°Ğ±Ğ¸Ğ»ÑŒĞ½Ñ‹Ñ… Ñ‚ĞµÑÑ‚Ğ¾Ğ²
